{% extends "base.html" %}
{% load i18n %}
{% load humanize %}
{% load app_extras %}
{% block content %}
  <div class="container">
    <!-- Profile Menu -->
    {% with current_tab='transactions' %}
      {% include "merchants/breadcrumb.html" %}
    {% endwith %}
  <div class="col-sm-12 col-xs-12 col-md-9">

        <h4 class="hl"><i class="fa fa-map-marker"></i> {% trans "Transactions" %}</h4>
          <table class="table table-condensed" style="border-collapse:collapse;">
            <thead>
              <tr>
                <th>{% trans "When" %}</th>
                <th>{% trans "Type" %}</th>
                <th>{% trans "Shopper" %}</th>
                <th>{% trans "Bitcoin" %}</th>
                <th>{% trans "Cash" %}</th>
                <th>{% trans "Wallet" %}</th>
                <th>{% trans "Status" %}</th>
              </tr>
            </thead>
          <tbody>
            {% if transactions %}
              {% for transaction in transactions %}
                <tr data-toggle="collapse" data-target="#row-{{transaction.id}}" class="accordion-toggle">
                  <td>{{transaction.added_at|naturaltime}}</td>
                  <td>{{transaction.get_type}}</td>
                  <td>{{ transaction.get_shopper.get_transaction_table_string }}</td>
                  <td>{{transaction.format_satoshis_amount}}</td>
                  <td>{{transaction.get_fiat_amount_formatted}}</td>
                  <td>
                    {% if transaction.credential.credential_type == 'CBS' %}
                      <a href="https://coinbase.com/accounts/" target="_blank">CoinBase</a>
                    {% elif transaction.credential.credential_type == 'BTS' %}
                      <a href="https://www.bitstamp.net/account/transactions/" target="_blank">BitStamp</a>
                    {% elif transaction.credential.credential_type == 'BCI' %}
                      <a href="https://blockchain.info/wallet/login" target="_blank">BlockChain</a>
                    {% else %}
                      Bitcoin Network
                    {% endif %}
                  </td>
                  <td>
                    {% if transaction.txn_hash or transaction.btc_transaction.txn_hash %}
                      <a href="https://blockchain.info/tx/{% firstof transaction.txn_hash transaction.btc_transaction.txn_hash %}" target="_blank">{{transaction.get_status|format_status_string}}</a>
                    {% elif transaction.b58_address %}
                      <a href="https://blockchain.info/address/{{ transaction.b58_address }}" target="_blank">{{transaction.get_status|format_status_string}}</a>
                    {% else %}
                      <a href="https://coinbase.com/accounts/" target="_blank">{{transaction.get_status|format_status_string}}</a>
                    {% endif %}
                  </td>
                </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="5" style="text-align: center;">
                  {% trans "You have no transactions yet"%}.
                </td>
              </tr>
            {% endif %}
          </tbody>
          </table>
    </div>
    </div>
    </div>
{% endblock content %}
{% block extra_js %}
{% endblock %}
