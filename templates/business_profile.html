{% extends "base.html" %}
{% block content %}
    <div class="container">
        <div class="page-header">
            <h1>Settings</h1>
        </div>

        <div class="row">
      <!-- Profile Menu -->
    <div class="col-sm-4 col-md-3">
      <div class="user-menu bottom-15">
        <ul>
          <li>
            <a href="{% url "business.views.business_settings" %}">
            <i class="sign fa fa-gears bg-green"></i>Settings <i class="fa fa-chevron-right pull-right"></i>
            </a>  
          </li>
          <li>
            <a href="#" class="active">
            <i class="sign fa fa-users bg-blue"></i>Profile <i class="fa fa-chevron-right pull-right"></i>
          </a>  
          </li>
          <li>
            <a href="{% url "business.views.transactions" %}">
            <i class="sign fa fa-sign-out bg-amethyst"></i> Transactions <i class="fa fa-chevron-right pull-right"></i>
          </a>  
          </li>
        </ul>
      </div>

  </div>
  <div class="col-sm-8 col-md-9">

      <div class="row">
        <div class="col-sm-12">
          <h4 class="hl">
            <a style="color:#515151;" href="#">Business Info</a>
            <a href="#" onclick="editBusinessInfo();" id="business-info-edit-button"><i class="fa fa-pencil-square-o"></i></a>
          </h4>
          <table id="business-info-list" class="table">
            <tbody>
              <tr>
                <td class="text-muted">Business Name</td>
                <td align="right">{{business.business_name}}</td>
              </tr>
              <tr>
                <td class="text-muted">Adress Line 1</td>
                <td align="right">{{business.address_1}}</td>
              </tr>
              <tr>
                <td class="text-muted">Address Line 2</td>
                <td align="right">{{business.address_2}}</td>
              </tr>
              <tr>
                <td class="text-muted">City</td>
                <td align="right">{{business.city}}</td>
              </tr>
              <tr>
                <td class="text-muted">State</td>
                <td align="right">{{business.state}}</td>
              </tr>
              <tr>
                <td class="text-muted">Country</td>
                <td align="right">{{business.country}}</td>
              </tr>
              <tr>
                <td class="text-muted">Zip Code</td>
                <td align="right">{{business.zip_code}}</td>
              </tr>
              <tr>
                <td class="text-muted">Phone Number</td>
                <td align="right">{{business.phone_num}}</td>
              </tr>
            </tbody>
          </table>
          <span class="hidden" id="business-info-edit">
            <form class="form-horizontal" method="post" action="{% url "business.views.edit_business_info" %}" >
              {% load crispy_forms_tags %}
              {{ business_form|crispy }}
              {% csrf_token %}
              <div class="button-wrapper">
                <button type="submit" class="btn btn-primary btn-lg">Submit</button>
              </div>
            </form>
          </span>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-12">
          <h4 class="hl">
            <a style="color:#515151;" href="#">Personal Info</a>
            <a href="#" onclick="editPersonalInfo();" id="personal-info-edit-button"><i class="fa fa-pencil-square-o"></i></a>
          </h4>
          <table id="personal-info-list" class="table">
            <tbody>
              <tr>
                <td class="text-muted">Name</td>
                <td align="right">{{user.full_name}}</td>
              </tr>
              <tr>
                <td class="text-muted">Email</td>
                <td align="right">{{user.email}}</td>
              </tr>
              <tr>
                <td class="text-muted">Phone Number</td>
                <td align="right">{{user.phone_num}}</td>
              </tr>
            </tbody>
          </table>
          <span class="hidden" id="personal-info-edit">
            
            <form class="form-horizontal" method="post" action="{% url "business.views.edit_personal_info" %}" >
              {% load crispy_forms_tags %}
              {{ personal_form|crispy }}
              {% csrf_token %}
              <div class="button-wrapper">
                <button type="submit" class="btn btn-primary btn-lg">Submit</button>
              </div>
            </form>
          </span>
        </div>
      </div>

        <!-- <ul><b>Bitcoin Info</b> <a class="btn btn-primary btn-sm" onclick="editBitcoinInfo();" id="bitcoin-info-edit-button">Edit</a>
          <span id="bitcoin-info-list">
            <li>Currency: {{business.get_currency_name}}</li>
            <li>Percent Markup: {{business.get_percent_markup}}%</li>
            <li>BTC Storage Address: {{business.btc_storage_address}}%</li>
          </span>
          <span class="hidden" id="bitcoin-info-edit">
          <form class="form-horizontal" method="post" action="{% url "business.views.edit_bitcoin_info" %}" >
              {% load crispy_forms_tags %}
              {{ bitcoin_form|crispy }}
              {% csrf_token %}
              <div class="button-wrapper">
                <button type="submit" class="btn btn-primary btn-lg">Submit</button>
              </div>
            </form>
          </span>
        </ul> -->

        <hr>
        <br/>
        <h4 class="hl"><i class="fa fa-map-marker"></i> Transactions</h4>
          <table class="table table-condensed" style="border-collapse:collapse;">
            <thead>
              <tr>
                <th></th>
                <th>Date</th>
                <th>Amount (btc)</th>
                <th>Amount (fiat)</th>
                <th>Confirmations</th>
              </tr>
            </thead>
          <tbody>
            {% if transactions %}
              {% for transaction in transactions %}
                <tr data-toggle="collapse" data-target="#row-{{transaction.id}}" class="accordion-toggle">
                  <td>
                    <i class="fa fa-plus-square-o text-blue" style="font-size: 18px;cursor: pointer;">
                    </i>
                  </td>
                  <td>{{transaction.added_at}}</td>
                  <td>{{transaction.satoshis}}</td>
                  <td>{{transaction.fiat_amount}}</td>
                  <td>{{transaction.conf_num}}</td>
                  
                </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="5" style="text-align: center;">
                  You have no transactions yet.
                </td>
              </tr>
            {% endif %}
          </tbody>
          </table>
    </div>
    </div>
    </div>
{% endblock content %}
{% block extra_js %}
  <script>
    function editPersonalInfo() {
        $("#personal-info-list").toggleClass("show hidden");
        $("#personal-info-edit").toggleClass("show hidden");
        var edit_button = $("#personal-info-edit-button");
        if (edit_button.text()=="Edit"){
          edit_button.text("Cancel");
        }else{
          edit_button.text("Edit");
        }        
    }

    function editBusinessInfo() {
        $("#business-info-list").toggleClass("show hidden");
        $("#business-info-edit").toggleClass("show hidden");
        var edit_button = $("#business-info-edit-button");
        if (edit_button.text()=="Edit"){
          edit_button.text("Cancel");
        }else{
          edit_button.text("Edit");
        }
    }

    function editBitcoinInfo() {
        $("#bitcoin-info-list").toggleClass("show hidden");
        $("#bitcoin-info-edit").toggleClass("show hidden");
        var edit_button = $("#bitcoin-info-edit-button");
        if (edit_button.text()=="Edit"){
          edit_button.text("Cancel");
        }else{
          edit_button.text("Edit");
        }
    }
  </script>
{% endblock %}